---

- name: Ensure a virtual network for the Kubernetes cluster is present.
  shell: >
    az network vnet list -o json |
    jq -r '.[] | select(.name == "tthw-subnet") | .ipAddress'
  register: result
  ignore_errors: true

- fail:
    msg: "Expected '10.0.0.0/16' but got '{{ result.stdout }}'"
  when: result.rc != 0 or result.stdout != "10.0.0.0/16"

